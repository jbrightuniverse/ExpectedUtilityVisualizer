See the included PDF and annotated code for explanations as this is a complex project.
